/* Copyright(c) 2023 Odey John Ebinyi
*  All Rights Reserved
* 
*  Description: This program assesses a C and C++ program for vulnerabilities
* 				like Buffer overflow.
*/

#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "utils.h"

#define NUM_CMDLINE_ARGS 2

int main(int argc, char *argv[])
{
	if(argc < NUM_CMDLINE_ARGS)
	{
		system("clear");
		fprintf(stderr, "\033[1;31m\n\tUsage\033[0m: \033[1;32m./vuln_checker <program_file>\033[0m");
		exit(EXIT_FAILURE);
	}
	
	// display banner.
	banner();
	
	// holds each word read from the source file.
	char buffer[100];
	
	// get the file type.
	const char *file_type = get_file_type(argv[1]);
	
	// determine if the file type is supported
	if(strcmp(file_type ,"unknown") == 0)
	{
		fprintf(stderr, "\033[1;31m\n\tERROR\033[0m: \033[1;31mFile type not supported. We only support: .c, and .cpp\033[0m");
		exit(EXIT_FAILURE);
	}
	
	// store the source file passed on the command line.
	const char *filename = argv[1];
	
	// Read the source file.
	read_program_file(filename, buffer);
}
